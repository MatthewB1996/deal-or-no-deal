<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Deal or No Deal â€“ Classroom Edition</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background:#111;
    color:white;
    margin:0;
    padding:20px;
  }

  h1 {
    text-align:center;
    margin-bottom:5px;
  }

  #instructions {
    text-align:center;
    font-size:20px;
    margin-top:0;
    margin-bottom:15px;
  }

  /* TWO COLUMN LAYOUT */
  #game-container {
    display:flex;
    justify-content:center;
    gap:30px;
    max-width:1600px;
    margin:0 auto;
  }

  /* CASE GRID */
  .case-grid {
    display:grid;
    grid-template-columns:repeat(5, 1fr);
    gap:15px;
    width:900px;
  }

  .case {
    background:linear-gradient(to bottom, #ffd700, #e6a600);
    border:4px solid #b8860b;
    border-radius:12px;
    padding:30px;
    text-align:center;
    font-size:32px;
    font-weight:bold;
    cursor:pointer;
    transition:transform 0.2s;
  }

  .case:hover {
    transform:scale(1.08);
  }

  .opened {
    background:#444 !important;
    color:white !important;
    cursor:default !important;
    transform:none !important;
  }

  .main-case {
    box-shadow:0 0 0 5px #00bfff;
  }

  /* SIDE PANEL (RIGHT SIDE) */
  #side-panel {
    width:350px;
    display:flex;
    flex-direction:column;
    gap:20px;
  }

  #amounts-box, #game-info-box {
    background:#222;
    padding:15px;
    border-radius:12px;
    font-size:18px;
  }

  #amounts-box ul {
    padding-left:20px;
    margin-top:10px;
  }

  #offer-panel {
    background:#003366;
    padding:15px;
    border-radius:12px;
    display:none;
  }

  #bank-offer-text {
    font-size:22px;
    margin-bottom:12px;
  }

  #deal-button, #nodeal-button {
    margin:5px;
    padding:12px 24px;
    font-size:20px;
    border-radius:8px;
    cursor:pointer;
    border:none;
  }

  #deal-button {
    background:#28a745;
    color:white;
  }

  #nodeal-button {
    background:#c82333;
    color:white;
  }

  #final-message {
    text-align:center;
    font-size:26px;
    margin-top:20px;
    font-weight:bold;
  }
</style>
</head>

<body>

<h1>ðŸŽ‰ Deal or No Deal ðŸŽ‰</h1>
<p id="instructions">Step 1: Choose your main case. This will be opened last.</p>

<div id="game-container">

  <!-- LEFT: CASE GRID -->
  <div class="case-grid" id="case-grid"></div>

  <!-- RIGHT: INFORMATION PANELS -->
  <div id="side-panel">

    <div id="amounts-box">
      <strong>Remaining Amounts:</strong>
      <ul id="remaining"></ul>
    </div>

    <div id="game-info-box">
      <p><strong>Main case:</strong> <span id="main-case-label">Not chosen</span></p>
      <p><strong>Game phase:</strong> <span id="phase-label">Choose main case</span></p>
      <p><strong>Current round:</strong> <span id="round-label">â€“</span></p>
      <p><strong>Cases to open:</strong> <span id="to-open-label">â€“</span></p>
      <p><strong>Opened this round:</strong> <span id="opened-this-round-label">0</span></p>
      <p><strong>Other unopened cases:</strong> <span id="others-remaining-label">25</span></p>
    </div>

    <div id="offer-panel">
      <p id="bank-offer-text"></p>
      <button id="deal-button" onclick="takeDeal()">Deal</button>
      <button id="nodeal-button" onclick="noDeal()">No Deal</button>
    </div>

  </div>
</div>

<p id="final-message"></p>

<script>
  // 26 prize amounts
  let amounts = [
    1, 5, 10, 20, 50, 75,
    100, 200, 300, 400, 500,
    750, 1000, 2500, 5000,
    10000, 20000, 50000, 75000,
    100000, 200000, 300000,
    500000, 750000, 1000000,
    2000000
  ];

  let shuffled = shuffle(amounts.slice());
  let openedIndices = new Set();
  let mainCaseIndex = null;
  let mainCaseAmount = null;

  // Game phase
  let gamePhase = "chooseMain";

  // Official round structure
  const baseRoundTargets = [6, 5, 4, 3, 2, 1];
  let roundIndex = 0;
  let openedThisRound = 0;
  let currentOffer = 0;

  function shuffle(a) {
    for (let i = a.length - 1; i > 0; i--) {
      let j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  function init() {
    let grid = document.getElementById("case-grid");
    for (let i = 0; i < 26; i++) {
      let box = document.createElement("div");
      box.className = "case";
      box.id = "case" + i;
      box.innerHTML = (i + 1);
      box.onclick = () => handleCaseClick(i);
      grid.appendChild(box);
    }
    updateRemaining();
    updateRoundInfo();
  }

  function handleCaseClick(i) {
    if (gamePhase === "chooseMain") {
      selectMainCase(i);
      return;
    }

    if (gamePhase === "openCases") {
      if (i === mainCaseIndex) return;
      if (openedIndices.has(i)) return;
      openCase(i);
      return;
    }

    if (gamePhase === "revealMain" && i === mainCaseIndex) {
      revealMainCase();
      return;
    }
  }

  function selectMainCase(i) {
    mainCaseIndex = i;
    mainCaseAmount = shuffled[i];
    let el = document.getElementById("case" + i);
    el.classList.add("main-case");

    document.getElementById("main-case-label").textContent = (i + 1);
    document.getElementById("instructions").textContent =
      "Now open " + currentRoundTarget() + " cases.";

    gamePhase = "openCases";
    updateRoundInfo();
  }

  function openCase(i) {
    openedIndices.add(i);
    let el = document.getElementById("case" + i);
    el.classList.add("opened");
    el.textContent = "$" + shuffled[i].toLocaleString();

    openedThisRound++;
    updateRemaining();
    updateRoundInfo();
    checkRoundEnd();
  }

  function unopenedNonMainCount() {
    let count = 0;
    for (let i = 0; i < shuffled.length; i++) {
      if (i !== mainCaseIndex && !openedIndices.has(i)) count++;
    }
    return count;
  }

  function currentRoundTarget() {
    if (roundIndex < baseRoundTargets.length)
      return baseRoundTargets[roundIndex];
    return 1;
  }

  function checkRoundEnd() {
    let remainingOthers = unopenedNonMainCount();
    if (remainingOthers === 0) {
      startFinalReveal();
      return;
    }

    if (openedThisRound >= currentRoundTarget()) {
      makeOffer();
    }
  }

  function updateRemaining() {
    let list = document.getElementById("remaining");
    list.innerHTML = "";

    let remaining = shuffled.filter((v, idx) => !openedIndices.has(idx));
    remaining.sort((a, b) => a - b);

    remaining.forEach(val => {
      let li = document.createElement("li");
      li.textContent = "$" + val.toLocaleString();
      list.appendChild(li);
    });
  }

  function updateRoundInfo() {
    document.getElementById("phase-label").textContent =
      gamePhase === "chooseMain" ? "Choose main case" :
      gamePhase === "openCases" ? "Opening cases" :
      gamePhase === "awaitDecision" ? "Banker offer" :
      gamePhase === "revealMain" ? "Final reveal" :
      "Finished";

    document.getElementById("round-label").textContent =
      gamePhase === "chooseMain" || gamePhase === "revealMain"
        ? "â€“" : (roundIndex + 1);

    document.getElementById("to-open-label").textContent =
      gamePhase === "openCases"
        ? currentRoundTarget() : "â€“";

    document.getElementById("opened-this-round-label").textContent =
      openedThisRound;

    document.getElementById("others-remaining-label").textContent =
      unopenedNonMainCount();
  }

  function makeOffer() {
    let remaining = shuffled.filter((v, idx) => !openedIndices.has(idx));
    let avg = remaining.reduce((a, b) => a + b, 0) / remaining.length;
    currentOffer = Math.round(avg * 0.75);

    document.getElementById("bank-offer-text").innerHTML =
      "ðŸ’¼ Banker offers: <strong>$" + currentOffer.toLocaleString() + "</strong>";
    document.getElementById("offer-panel").style.display = "block";

    document.getElementById("instructions").textContent = "Deal or No Deal?";
    gamePhase = "awaitDecision";
    updateRoundInfo();
  }

  function takeDeal() {
    gamePhase = "finished";
    document.getElementById("offer-panel").style.display = "none";

    revealAllCases(true);

    document.getElementById("final-message").textContent =
      "DEAL! You took $" + currentOffer.toLocaleString() +
      ". Your original case contained $" + mainCaseAmount.toLocaleString() + ".";
    document.getElementById("instructions").textContent =
      "Game over â€“ you accepted the deal.";
  }

  function noDeal() {
    document.getElementById("offer-panel").style.display = "none";
    roundIndex++;
    openedThisRound = 0;

    document.getElementById("instructions").textContent =
      "No Deal! Open " + currentRoundTarget() + " more case(s).";

    gamePhase = "openCases";
    updateRoundInfo();
  }

  function startFinalReveal() {
    gamePhase = "revealMain";
    document.getElementById("offer-panel").style.display = "none";

    document.getElementById("instructions").textContent =
      "Only your original case remains. Click it to reveal!";
    updateRoundInfo();
  }

  function revealMainCase() {
    let el = document.getElementById("case" + mainCaseIndex);
    el.classList.add("opened");
    el.innerHTML =
      "Your Case<br>$" + mainCaseAmount.toLocaleString();

    openedIndices.add(mainCaseIndex);
    updateRemaining();

    gamePhase = "finished";
    document.getElementById("final-message").textContent =
      "NO DEAL! Your original case contained $" +
      mainCaseAmount.toLocaleString() + ".";
    document.getElementById("instructions").textContent =
      "Game over!";
  }

  function revealAllCases(includeMain) {
    for (let i = 0; i < shuffled.length; i++) {
      let el = document.getElementById("case" + i);
      if (!el) continue;

      if (i === mainCaseIndex && includeMain) {
        el.classList.add("opened");
        el.innerHTML =
          "Your Case<br>$" + mainCaseAmount.toLocaleString();
      } else {
        el.classList.add("opened");
        el.textContent = "$" + shuffled[i].toLocaleString();
      }
    }
  }

  init();
</script>

</body>
</html>
